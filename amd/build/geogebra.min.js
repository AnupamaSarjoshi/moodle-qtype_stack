/**
 * geogebra embedding used by geogebra.block.php
 * derived by jsxGraph STACK implementation
 * @copyright  2022 University of Edinburgh
 * @author     Tim Lutz
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("qtype_stack/geogebra",["qtype_stack/geogebracore-lazy"],(function(GEOGEBRA){return{find_input_id:function(divid,name){for(var tmp=document.getElementById(divid);(tmp=tmp.parentElement)&&(!tmp.classList.contains("formulation")||!tmp.parentElement.classList.contains("content")););return(tmp=tmp.querySelector('input[id$="_'+name+'"]')).addEventListener("change",(function(){M.core_formchangechecker.set_form_changed()})),tmp.id},bind_point:function(inputRef,appletRef,pointname){var theInput=document.getElementById(inputRef);if(void 0!==theInput.value&&""!=theInput.value){var coords=JSON.parse(theInput.value);try{appletRef.setCoords(pointname,coords[0],coords[1])}catch(err){}}var initialX=appletRef.getXcoord(pointname),initialY=appletRef.getYcoord(pointname);setInterval((function(){var pointx=appletRef.getXcoord(pointname),pointy=appletRef.getYcoord(pointname);if(initialX!==pointx||initialY!==pointy){var tmp=JSON.stringify([pointx,pointy]);if(initialX=!1,initialY=!1,theInput.value!=tmp&&(theInput.value=tmp,-1===window.location.pathname.indexOf("preview.php"))){var e=new Event("change");theInput.dispatchEvent(e)}}}),300);var lastValue=JSON.stringify([appletRef.getXcoord(pointname),appletRef.getYcoord(pointname)]);theInput.addEventListener("input",(function(){if(theInput.value!=lastValue){try{var tmp=JSON.parse(theInput.value);"number"==typeof tmp[0]&&"number"==typeof tmp[1]&&appletRef.setCoords(pointname,tmp)}catch(err){}lastValue=theInput.value}})),theInput.addEventListener("change",(function(){if(theInput.value!=lastValue){try{var tmp=JSON.parse(theInput.value);"number"==typeof tmp[0]&&"number"==typeof tmp[1]&&appletRef.setCoords(pointname,tmp)}catch(err){}lastValue=theInput.value}}))},bind_value:function(inputRef,appletRef,valuename){var theInput=document.getElementById(inputRef);if(void 0!==theInput.value&&""!=theInput.value)try{appletRef.setValue(valuename,JSON.parse(theInput.value))}catch(err){}var initialValue=appletRef.getValue(valuename),movedInitial=!1;setInterval((function(){if(0==movedInitial&&initialValue!=appletRef.getValue(valuename)&&(movedInitial=!0),movedInitial){var tmp=JSON.stringify(appletRef.getValue(valuename));if(theInput.value!=tmp&&(theInput.value=tmp,-1===window.location.pathname.indexOf("preview.php"))){var e=new Event("change");theInput.dispatchEvent(e)}}}),300);var lastValue=JSON.stringify(appletRef.getValue(valuename));theInput.addEventListener("input",(function(){if(theInput.value!==lastValue){try{var tmp=JSON.parse(theInput.value);"number"==typeof tmp&&appletRef.setValue(valuename,tmp)}catch(err){}lastValue=theInput.value}})),theInput.addEventListener("change",(function(){if(theInput.value!==lastValue){try{var tmp=JSON.parse(theInput.value);"number"==typeof tmp&&appletRef.setValue(valuename,tmp)}catch(err){}lastValue=theInput.value}}))},bind_value_to_remember_JSON:function(inputRef,appletRef,valuename){var theInput=document.getElementById(inputRef);if(void 0!==theInput.value&&""!=theInput.value)try{appletRef.setValue(valuename,JSON.parse(theInput.value)[valuename])}catch(err){}var initialValue=appletRef.getValue(valuename),movedInitial=!1;setInterval((function(){if(0===theInput.value.trim().length&&(theInput.value="{}"),0==movedInitial&&initialValue!=appletRef.getValue(valuename)&&(movedInitial=!0),movedInitial){var tmpValue=appletRef.getValue(valuename);try{var lastinput=JSON.parse(theInput.value)}catch(err){}if(!(lastinput&&lastinput[valuename]&&lastinput[valuename]==tmpValue||(lastinput[valuename]=tmpValue,theInput.value=JSON.stringify(lastinput),-1!==window.location.pathname.indexOf("preview.php")))){var e=new Event("change");theInput.dispatchEvent(e)}}}),300);var lastValue=JSON.stringify(appletRef.getValue(valuename));theInput.addEventListener("input",(function(){try{var tmp=JSON.parse(theInput.value);JSON.stringify(tmp[valuename])!==lastValue&&"number"==typeof tmp[valuename]&&appletRef.setValue(valuename,tmp[valuename]),lastValue=JSON.stringify(tmp[valuename])}catch(err){}})),theInput.addEventListener("change",(function(){try{var tmp=JSON.parse(theInput.value);tmp[valuename]!==lastValue&&("number"==typeof tmp[valuename]&&appletRef.setValue(valuename,tmp[valuename]),lastValue=JSON.stringify(tmp[valuename]))}catch(err){}}))},bind_point_to_remember_JSON:function(inputRef,appletRef,pointname){var theInput=document.getElementById(inputRef);if(void 0!==theInput.value&&""!=theInput.value){var coords=JSON.parse(theInput.value)[pointname];try{appletRef.setCoords(pointname,coords[0],coords[1])}catch(err){}}var initialX=appletRef.getXcoord(pointname),initialY=appletRef.getYcoord(pointname);setInterval((function(){0===theInput.value.trim().length&&(theInput.value="{}");var pointx=appletRef.getXcoord(pointname),pointy=appletRef.getYcoord(pointname);if(initialX!==pointx||initialY!==pointy){var tmpValue=[pointx,pointy];initialX=!1,initialY=!1;try{var lastinput=JSON.parse(theInput.value)}catch(err){}if(!(lastinput&&lastinput[pointname]&&lastinput[pointname][0]==tmpValue[0]&&lastinput[pointname][1]==tmpValue[1]||(lastinput[pointname]=tmpValue,theInput.value=JSON.stringify(lastinput),-1!==window.location.pathname.indexOf("preview.php")))){var e=new Event("change");theInput.dispatchEvent(e)}}}),300);var lastValue=JSON.stringify([appletRef.getXcoord(pointname),appletRef.getYcoord(pointname)]);theInput.addEventListener("input",(function(){try{var tmp=JSON.parse(theInput.value);JSON.stringify(tmp[pointname])!==lastValue&&("number"==typeof tmp[pointname][0]&&"number"==typeof tmp[pointname][1]&&appletRef.setCoords(pointname,tmp[pointname]),lastValue=JSON.stringify(tmp[pointname]))}catch(err){}})),theInput.addEventListener("change",(function(){try{var tmp=JSON.parse(theInput.value);JSON.stringify(tmp[pointname])!==lastValue&&("number"==typeof tmp[pointname][0]&&"number"==typeof tmp[pointname][1]&&appletRef.setCoords(pointname,tmp[pointname]),lastValue=JSON.stringify(tmp[pointname]))}catch(err){}}))}}}));

//# sourceMappingURL=geogebra.min.js.map